<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">SQL with Google Colab Tutorial 1</h1><p class="page-description">PostgreSQL with Google Colab Tutorial 1</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-11-15T00:00:00-06:00" itemprop="datePublished">
        Nov 15, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      32 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/data_science_blog/categories/#PostgreSQL wit Google Colab">PostgreSQL wit Google Colab</a>
        &nbsp;
      
        <a class="category-tags-link" href="/data_science_blog/categories/#SQL">SQL</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/leonardodecastro/data_science_blog/tree/master/_notebooks/2022-11-15-SQL-Tutorial-1.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/data_science_blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/leonardodecastro/data_science_blog/master?filepath=_notebooks%2F2022-11-15-SQL-Tutorial-1.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/data_science_blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/leonardodecastro/data_science_blog/blob/master/_notebooks/2022-11-15-SQL-Tutorial-1.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/data_science_blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#1)-Aknowledge-the-sources-used-for-this-tutorial">1) Aknowledge the sources used for this tutorial </a></li>
<li class="toc-entry toc-h2"><a href="#2)-Import-libraries">2) Import libraries </a></li>
<li class="toc-entry toc-h2"><a href="#3)-Install-PostgreSQL">3) Install PostgreSQL </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Colab-is-a-linux-environment.-Thus,-we-can-use-linux-commands-to-install--PostgreSQL-on-it">Colab is a linux environment. Thus, we can use linux commands to install  PostgreSQL on it </a></li>
<li class="toc-entry toc-h3"><a href="#Setup-necessary-environmental-variables">Setup necessary environmental variables </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#4)-Create-tables-within-the-database">4) Create tables within the database </a>
<ul>
<li class="toc-entry toc-h3"><a href="#4.1)-Drop-tables-if-they-already-exist">4.1) Drop tables if they already exist </a></li>
<li class="toc-entry toc-h3"><a href="#4.2)-Create-tables">4.2) Create tables </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#5)-Populate-the-tables">5) Populate the tables </a>
<ul>
<li class="toc-entry toc-h3"><a href="#5.1)-Import-CSV-files">5.1) Import CSV files </a></li>
<li class="toc-entry toc-h3"><a href="#5.2)-Populate-the-tables">5.2) Populate the tables </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#6)-Practice-SQL">6) Practice SQL </a>
<ul>
<li class="toc-entry toc-h3"><a href="#6.1)-SELECT,-WHERE-&-ORDER-BY-commands">6.1) SELECT, WHERE &amp; ORDER BY commands </a>
<ul>
<li class="toc-entry toc-h4"><a href="#6.1.1)-Select-all-columns-using-asterisk-(*).">6.1.1) Select all columns using asterisk (*). </a></li>
<li class="toc-entry toc-h4"><a href="#6.1.2)-Select-certain-columns-of-a-given-table.">6.1.2) Select certain columns of a given table. </a></li>
<li class="toc-entry toc-h4"><a href="#6.1.3)-Create-aggregate-measures-(SUM).">6.1.3) Create aggregate measures (SUM). </a></li>
<li class="toc-entry toc-h4"><a href="#6.1.4)-Minimum,-Maximum-and-Average-Metrics.">6.1.4) Minimum, Maximum and Average Metrics. </a></li>
<li class="toc-entry toc-h4"><a href="#6.1.5)-WHERE-and-ORDER-BY-command">6.1.5) WHERE and ORDER BY command </a></li>
<li class="toc-entry toc-h4"><a href="#6.1.6)-Summary">6.1.6) Summary </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#6.2)-FILTER-&-GROUP-commands">6.2) FILTER &amp; GROUP commands </a>
<ul>
<li class="toc-entry toc-h4"><a href="#6.2.1)-LIMIT-command">6.2.1) LIMIT command </a></li>
<li class="toc-entry toc-h4"><a href="#6.2.2)-Multiple-WHERE-commands">6.2.2) Multiple WHERE commands </a></li>
<li class="toc-entry toc-h4"><a href="#6.2.3)-BETWEEN-command">6.2.3) BETWEEN command </a></li>
<li class="toc-entry toc-h4"><a href="#6.2.4)-AS-command">6.2.4) AS command </a></li>
<li class="toc-entry toc-h4"><a href="#6.2.5)-GROUP-BY-+-HAVING-command">6.2.5) GROUP BY + HAVING command </a></li>
<li class="toc-entry toc-h4"><a href="#6.2.6)-Summary">6.2.6) Summary </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#6.3)-Aggregating-and-Grouping-Data">6.3) Aggregating and Grouping Data </a>
<ul>
<li class="toc-entry toc-h4"><a href="#6.3.1)-DISTINCT,-ROUND,-COUNT-and-Multiple-GROUP-BY-commmands">6.3.1) DISTINCT, ROUND, COUNT and Multiple GROUP BY commmands </a></li>
<li class="toc-entry toc-h4"><a href="#6.3.2)-IN-commmand">6.3.2) IN commmand </a></li>
<li class="toc-entry toc-h4"><a href="#6.3.3)-COUNT(*)-and-CAST-commmands">6.3.3) COUNT(*) and CAST commmands </a></li>
<li class="toc-entry toc-h4"><a href="#6.3.4)-LEFT-JOIN-+-USING-commands">6.3.4) LEFT JOIN + USING commands </a></li>
<li class="toc-entry toc-h4"><a href="#6.3.5)-LEFT-JOIN-+-ON-commands">6.3.5) LEFT JOIN + ON commands </a></li>
<li class="toc-entry toc-h4"><a href="#6.3.6)-NOT-IN-command">6.3.6) NOT IN command </a></li>
<li class="toc-entry toc-h4"><a href="#6.3.7)-Summary">6.3.7) Summary </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#6.4)-JOIN-command">6.4) JOIN command </a>
<ul>
<li class="toc-entry toc-h4"><a href="#6.4.1)-INNER-JOIN-command">6.4.1) INNER JOIN command </a></li>
<li class="toc-entry toc-h4"><a href="#6.4.2)-Divide-one-column-by-another-(feature-creation)">6.4.2) Divide one column by another (feature creation) </a></li>
<li class="toc-entry toc-h4"><a href="#6.4.3)-COUNT-+-DISTINCT-commands">6.4.3) COUNT + DISTINCT commands </a></li>
<li class="toc-entry toc-h4"><a href="#6.4.4)-IS-NOT-NULL-command">6.4.4) IS NOT NULL command </a></li>
<li class="toc-entry toc-h4"><a href="#6.4.5)-CASE-+-COALESCE-commands">6.4.5) CASE + COALESCE commands </a></li>
<li class="toc-entry toc-h4"><a href="#6.4.6)-Summary">6.4.6) Summary </a></li>
</ul>
</li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-11-15-SQL-Tutorial-1.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1)-Aknowledge-the-sources-used-for-this-tutorial">
<a class="anchor" href="#1)-Aknowledge-the-sources-used-for-this-tutorial" aria-hidden="true"><span class="octicon octicon-link"></span></a>1) Aknowledge the sources used for this tutorial<a class="anchor-link" href="#1)-Aknowledge-the-sources-used-for-this-tutorial"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This post was created using information from 2 sources. The first post explains how to use PostgreSQL with Google Colab. The second source is a tutorial by at Data.World. The links to these sources are found below:</p>
<ul>
<li><a href="https://thivyapriyaa.medium.com/setting-up-postgresql-on-google-colab-4d02166939fc">https://thivyapriyaa.medium.com/setting-up-postgresql-on-google-colab-4d02166939fc</a></li>
<li><a href="https://data.world/classrooms/guide-to-data-analysis-with-sql-and-datadotworld/workspace/file?filename=01_select_data.md">https://data.world/classrooms/guide-to-data-analysis-with-sql-and-datadotworld/workspace/file?filename=01_select_data.md</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2)-Import-libraries">
<a class="anchor" href="#2)-Import-libraries" aria-hidden="true"><span class="octicon octicon-link"></span></a>2) Import libraries<a class="anchor-link" href="#2)-Import-libraries"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">psycopg2</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default='warn'</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3)-Install-PostgreSQL">
<a class="anchor" href="#3)-Install-PostgreSQL" aria-hidden="true"><span class="octicon octicon-link"></span></a>3) Install PostgreSQL<a class="anchor-link" href="#3)-Install-PostgreSQL"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Colab-is-a-linux-environment.-Thus,-we-can-use-linux-commands-to-install--PostgreSQL-on-it">
<a class="anchor" href="#Colab-is-a-linux-environment.-Thus,-we-can-use-linux-commands-to-install--PostgreSQL-on-it" aria-hidden="true"><span class="octicon octicon-link"></span></a>Colab is a linux environment. Thus, we can use linux commands to install  PostgreSQL on it<a class="anchor-link" href="#Colab-is-a-linux-environment.-Thus,-we-can-use-linux-commands-to-install--PostgreSQL-on-it"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You might need to run the following cell twice if the database is not created when you run it just once.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>sudo apt-get -y -qq update   # Update the PostgreSQL in <span class="k">case</span> they are not 
<span class="o">!</span>sudo apt-get -y -qq install postgresql # Install PostgreSQL 
<span class="o">!</span>sudo service postgresql start # Start the PostgreSQL service

<span class="c1"># Setup a password `postgres` for username `postgres`</span>
<span class="o">!</span>sudo -u postgres psql -U postgres -c <span class="s2">"ALTER USER postgres PASSWORD 'postgres';"</span>

<span class="c1"># Setup a database with name `tfio_demo` to be used</span>
<span class="o">!</span>sudo -u postgres psql -U postgres -c <span class="s1">'DROP DATABASE IF EXISTS tfio_demo;'</span>  # Drop databases <span class="k">if</span> they exist
<span class="o">!</span>sudo -u postgres psql -U postgres -c <span class="s1">'CREATE DATABASE tfio_demo;'</span> # Drop databases <span class="k">if</span> they exist
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> * Starting PostgreSQL 10 database server
   ...done.
ALTER ROLE
DROP DATABASE
CREATE DATABASE
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Setup-necessary-environmental-variables">
<a class="anchor" href="#Setup-necessary-environmental-variables" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup necessary environmental variables<a class="anchor-link" href="#Setup-necessary-environmental-variables"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">env</span> DB_NAME=tfio_demo
<span class="o">%</span><span class="k">env</span> DB_HOST=localhost
<span class="o">%</span><span class="k">env</span> DB_PORT=5432
<span class="o">%</span><span class="k">env</span> DB_USER=postgres
<span class="o">%</span><span class="k">env</span> DB_PASS= postgres
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>env: DB_NAME=tfio_demo
env: DB_HOST=localhost
env: DB_PORT=5432
env: DB_USER=postgres
env: DB_PASS=postgres
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="4)-Create-tables-within-the-database">
<a class="anchor" href="#4)-Create-tables-within-the-database" aria-hidden="true"><span class="octicon octicon-link"></span></a>4) Create tables within the database<a class="anchor-link" href="#4)-Create-tables-within-the-database"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.1)-Drop-tables-if-they-already-exist">
<a class="anchor" href="#4.1)-Drop-tables-if-they-already-exist" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.1) Drop tables if they already exist<a class="anchor-link" href="#4.1)-Drop-tables-if-they-already-exist"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span>-d <span class="nv">$DB_NAME</span> -c <span class="s2">"DROP TABLE IF EXISTS visitation;"</span>

<span class="c1">#### Table 2: Cats VS Dogs</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span>-d <span class="nv">$DB_NAME</span> -c <span class="s2">"DROP TABLE IF EXISTS animals;"</span>

<span class="c1">#### Table 3: Counties</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span>-d <span class="nv">$DB_NAME</span> -c <span class="s2">"DROP TABLE IF EXISTS counties;"</span>

<span class="c1">#### Table 4: Products</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span>-d <span class="nv">$DB_NAME</span> -c <span class="s2">"DROP TABLE IF EXISTS products;"</span>

<span class="c1">#### Table 5: Sales</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span>-d <span class="nv">$DB_NAME</span> -c <span class="s2">"DROP TABLE IF EXISTS sales;"</span>

<span class="c1">#### Table 6: Sales 2016</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span>-d <span class="nv">$DB_NAME</span> -c <span class="s2">"DROP TABLE IF EXISTS sales2016;"</span>

<span class="c1">#### Table 7: Stores</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span>-d <span class="nv">$DB_NAME</span> -c <span class="s2">"DROP TABLE IF EXISTS stores;"</span>

<span class="c1">#### Table 8: Convenience Stores</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span>-d <span class="nv">$DB_NAME</span> -c <span class="s2">"DROP TABLE IF EXISTS convenience;"</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.2)-Create-tables">
<a class="anchor" href="#4.2)-Create-tables" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.2) Create tables<a class="anchor-link" href="#4.2)-Create-tables"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"CREATE TABLE visitation(visitation_index SERIAL PRIMARY KEY,year INT,visitor_count INT,total_visitors INT);"</span>

<span class="c1">#### Table 2: Cats VS Dogs</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"CREATE TABLE animals(animal_index SERIAL PRIMARY KEY, location TEXT, region TEXT, number_of_households_in_1000 INT, </span><span class="se">\</span>
<span class="s2">                         percentage_of_households_with_pets DECIMAL(5,3), number_of_pet_households_in_1000 INT, percentage_of_dog_owners DECIMAL(5,3), </span><span class="se">\</span>
<span class="s2">                         dog_owning_households_1000s INT, mean_number_of_dogs_per_household DECIMAL(5,3), dog_population_in_1000 INT, </span><span class="se">\</span>
<span class="s2">                         percentage_of_cat_owners DECIMAL(5,3), cat_owning_households INT, mean_number_of_cats DECIMAL(5,3), cat_population INT);"</span>

<span class="c1">#### Table 3: Counties</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"CREATE TABLE counties(counties_index SERIAL PRIMARY KEY, county TEXT, county_number INT, population INT);"</span>

<span class="c1">#### Table 4: Products</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"CREATE TABLE products(products_index SERIAL PRIMARY KEY, item_no INT, category_name TEXT, item_description TEXT, </span><span class="se">\</span>
<span class="s2">                          vendor INT, vendor_name	TEXT, bottle_size INT, pack INT, inner_pack INT, age INT, proof INT, </span><span class="se">\</span>
<span class="s2">                           list_date DATE, upc BIGINT, scc BIGINT, bottle_price MONEY, shelf_price DECIMAL, case_cost DECIMAL);"</span>
<span class="c1">#### Table 5: Sales</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"CREATE TABLE sales(sales_index SERIAL PRIMARY KEY, date DATE,	convenience_store TEXT, </span><span class="se">\</span>
<span class="s2">                       store INT, county_number INT,	county TEXT,	category TEXT,	category_name TEXT,	vendor_no INT,	</span><span class="se">\</span>
<span class="s2">                       vendor TEXT,	item INT,	description TEXT,	pack INT,	liter_size INT,	state_btl_cost MONEY,	 </span><span class="se">\</span>
<span class="s2">                       btl_price MONEY,	bottle_qty INT,	total DECIMAL);"</span>

<span class="c1">#### Table 6: Sales 2016</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"CREATE TABLE sales_2016(sales2016_index SERIAL PRIMARY KEY, invoice_item_number TEXT, date DATE, store_number INT, store_name TEXT, address TEXT, </span><span class="se">\</span>
<span class="s2">       city TEXT, zip_Code TEXT, store_location TEXT, county_number TEXT, county TEXT, category TEXT, category_name TEXT, vendor_number TEXT, </span><span class="se">\</span>
<span class="s2">       vendor_name TEXT, item_number INT, item_description TEXT, pack INT, bottle_volume_ml INT, state_bottle_cost DECIMAL, state_bottle_retail DECIMAL, </span><span class="se">\</span>
<span class="s2">       bottles_sold INT, sale_dollars DECIMAL, volume_sold_liters DECIMAL, volume_sold_gallons DECIMAL);"</span>

<span class="c1">#### Table 7: Stores</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"CREATE TABLE stores(stores_index SERIAL PRIMARY KEY, store INT, name TEXT, store_status TEXT, store_address TEXT, address_info TEXT);"</span>

<span class="c1">#### Table 8: Convenience Stores</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"CREATE TABLE convenience(convenience_index SERIAL PRIMARY KEY, store INT,county TEXT);"</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="5)-Populate-the-tables">
<a class="anchor" href="#5)-Populate-the-tables" aria-hidden="true"><span class="octicon octicon-link"></span></a>5) Populate the tables<a class="anchor-link" href="#5)-Populate-the-tables"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.1)-Import-CSV-files">
<a class="anchor" href="#5.1)-Import-CSV-files" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.1) Import CSV files<a class="anchor-link" href="#5.1)-Import-CSV-files"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#### 5.1) Import the csv for the "visitation" table</span>
<span class="o">!</span>wget https://raw.githubusercontent.com/leonardodecastro/data/main/visitation.csv -nv

<span class="c1">#### 5.2) Import the csv for the "animals" table</span>
<span class="o">!</span>wget https://raw.githubusercontent.com/leonardodecastro/data/main/animals.csv -nv

<span class="c1">#### 5.3) Import the csv for the "counties" table</span>
<span class="o">!</span>wget https://raw.githubusercontent.com/leonardodecastro/data/main/counties.csv -nv

<span class="c1">#### 5.4) Import the csv for the "products" table</span>
<span class="o">!</span>wget https://raw.githubusercontent.com/leonardodecastro/data/main/products.csv -nv

<span class="c1">#### 5.5) Import the csv for the "sales" table</span>
<span class="o">!</span>wget https://raw.githubusercontent.com/leonardodecastro/data/main/sales.zip -nv
<span class="o">!</span>unzip <span class="s1">'/content/sales.zip'</span>

<span class="c1">#### 5.6) Import the csv for the "sales2016" table</span>
<span class="o">!</span>wget https://raw.githubusercontent.com/leonardodecastro/data/main/sales_2016.zip -nv
<span class="o">!</span>unzip <span class="s1">'/content/sales_2016.zip'</span>

<span class="c1">#### 5.7) Import the csv for the "stores" table</span>
<span class="o">!</span>wget https://raw.githubusercontent.com/leonardodecastro/data/main/stores.csv -nv

<span class="c1">#### 5.8) Import the csv for the "convenience" table</span>
<span class="o">!</span>wget https://raw.githubusercontent.com/leonardodecastro/data/main/convenience.csv -nv
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.2)-Populate-the-tables">
<a class="anchor" href="#5.2)-Populate-the-tables" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.2) Populate the tables<a class="anchor-link" href="#5.2)-Populate-the-tables"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#### 5.1) Populate the "visitation" table</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"\COPY visitation(year, visitor_count, total_visitors) FROM </span><span class="se">\</span>
<span class="s2">'visitation.csv' ( format csv, header, delimiter ',', encoding 'win1252', null ' ' );"</span>

<span class="c1">#### 5.2) Populate the "animals" table</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"\COPY animals(location, region, number_of_households_in_1000, percentage_of_households_with_pets, number_of_pet_households_in_1000,  </span><span class="se">\</span>
<span class="s2">                     percentage_of_dog_owners, dog_owning_households_1000s, mean_number_of_dogs_per_household , dog_population_in_1000, </span><span class="se">\</span>
<span class="s2">                     percentage_of_cat_owners, cat_owning_households, mean_number_of_cats , cat_population) FROM </span><span class="se">\</span>
<span class="s2">                     'animals.csv' ( format csv, header, delimiter ',', encoding 'win1252', null ' ' );"</span>

<span class="c1">#### 5.3) Populate the "counties" table</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"\COPY counties(county, county_number, population) FROM </span><span class="se">\</span>
<span class="s2">'counties.csv' ( format csv, header, delimiter ',', encoding 'win1252', null ' ' );"</span>

<span class="c1">#### 5.4) Populate the "products" table</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"\COPY products(item_no, category_name, item_description, vendor, vendor_name, bottle_size, pack, inner_pack, age, proof, </span><span class="se">\</span>
<span class="s2">                           list_date, upc, scc, bottle_price, shelf_price, case_cost) FROM </span><span class="se">\</span>
<span class="s2">'products.csv' ( format csv, header, delimiter ';', encoding 'win1252', null '');"</span>

<span class="c1">#### 5.5) Populate the "sales" table</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"\COPY sales(date,	convenience_store, store, county_number,	county,	category,	category_name,	vendor_no,	</span><span class="se">\</span>
<span class="s2">                       vendor,	item,	description,	pack,	liter_size,	state_btl_cost,	btl_price,	bottle_qty,	total) </span><span class="se">\</span>
<span class="s2">                       FROM 'sales.csv' ( format csv, header, delimiter ',', encoding 'win1252', null ' ' );"</span>

<span class="c1">#### 5.6) Populate the "sales2016" table</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"\COPY sales_2016(invoice_item_number, date, store_number, store_Name, address, </span><span class="se">\</span>
<span class="s2">       city, zip_code, store_location, county_number, county, category, category_name, vendor_number, </span><span class="se">\</span>
<span class="s2">       vendor_name, item_number, item_description, pack, bottle_volume_ml, state_bottle_cost, state_bottle_retail, </span><span class="se">\</span>
<span class="s2">       bottles_sold, sale_dollars, volume_sold_liters, volume_sold_gallons) FROM </span><span class="se">\</span>
<span class="s2">'sales_2016.csv' ( format csv, header, delimiter ',', encoding 'win1252', null ' ' );"</span>

<span class="c1">#### 5.7) Populate the "stores" table</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"\COPY stores(store, name, store_status, store_address, address_info) FROM </span><span class="se">\</span>
<span class="s2">'stores.csv' ( format csv, header, delimiter ',', encoding 'win1252', null ' ' );"</span>

<span class="c1">#### 5.8) Populate the "convenience" table</span>
<span class="o">!</span><span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$DB_PASS</span> psql -q -h <span class="nv">$DB_HOST</span> -p <span class="nv">$DB_PORT</span> -U <span class="nv">$DB_USER</span> -d <span class="nv">$DB_NAME</span> <span class="err">\</span>
<span class="o">-</span><span class="n">c</span> <span class="s2">"\COPY convenience(store, county) FROM </span><span class="se">\</span>
<span class="s2">'convenience.csv' ( format csv, header, delimiter ',', encoding 'win1252', null ' ' );"</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="6)-Practice-SQL">
<a class="anchor" href="#6)-Practice-SQL" aria-hidden="true"><span class="octicon octicon-link"></span></a>6) Practice SQL<a class="anchor-link" href="#6)-Practice-SQL"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The introduction to the sub-sections of part 6 were extracted from the second source referenced in the first part of this script.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.1)-SELECT,-WHERE-&amp;-ORDER-BY-commands">
<a class="anchor" href="#6.1)-SELECT,-WHERE-&amp;-ORDER-BY-commands" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.1) SELECT, WHERE &amp; ORDER BY commands<a class="anchor-link" href="#6.1)-SELECT,-WHERE-&amp;-ORDER-BY-commands"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When accessing data using SQL, <strong>Structured Query Language</strong>, the two foundational parts of the command sequence are <code>SELECT</code> and <code>FROM</code>. Using <code>SELECT</code>, you choose the information you want to include in your report. <code>FROM</code> identifies the source table or file name from which to retrieve or calculate that information. This structure will look like:</p>
<blockquote>
<p><strong>SELECT</strong> <em>(desired data here)</em> <br>
<strong>FROM</strong> <em>(table name here)</em></p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.1.1)-Select-all-columns-using-asterisk-(*).">
<a class="anchor" href="#6.1.1)-Select-all-columns-using-asterisk-(*)." aria-hidden="true"><span class="octicon octicon-link"></span></a>6.1.1) Select all columns using asterisk (*).<a class="anchor-link" href="#6.1.1)-Select-all-columns-using-asterisk-(*)."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select all columns from the <code>visitation</code> table.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT * </span><span class="se">\</span>
<span class="s2">                FROM visitation"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-88a36d3d-b866-40b2-b308-f6d935af6acd">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>visitation_index</th>
      <th>year</th>
      <th>visitor_count</th>
      <th>total_visitors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1944</td>
      <td>1409</td>
      <td>15431947</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1945</td>
      <td>3205</td>
      <td>15431947</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1946</td>
      <td>10037</td>
      <td>15431947</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1947</td>
      <td>28652</td>
      <td>15431947</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1948</td>
      <td>45670</td>
      <td>15431947</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-88a36d3d-b866-40b2-b308-f6d935af6acd')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-88a36d3d-b866-40b2-b308-f6d935af6acd button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-88a36d3d-b866-40b2-b308-f6d935af6acd');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.1.2)-Select-certain-columns-of-a-given-table.">
<a class="anchor" href="#6.1.2)-Select-certain-columns-of-a-given-table." aria-hidden="true"><span class="octicon octicon-link"></span></a>6.1.2) Select certain columns of a given table.<a class="anchor-link" href="#6.1.2)-Select-certain-columns-of-a-given-table."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>year</code> and <code>vistor_count</code> from the <code>visitation</code> table.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">" SELECT visitation.year, visitation.visitor_count </span><span class="se">\</span>
<span class="s2">                 FROM visitation; "</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-5cfbea6d-3ee1-49aa-aee3-0498edd976ca">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>year</th>
      <th>visitor_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1944</td>
      <td>1409</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1945</td>
      <td>3205</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1946</td>
      <td>10037</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1947</td>
      <td>28652</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1948</td>
      <td>45670</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5cfbea6d-3ee1-49aa-aee3-0498edd976ca')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5cfbea6d-3ee1-49aa-aee3-0498edd976ca button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5cfbea6d-3ee1-49aa-aee3-0498edd976ca');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.1.3)-Create-aggregate-measures-(SUM).">
<a class="anchor" href="#6.1.3)-Create-aggregate-measures-(SUM)." aria-hidden="true"><span class="octicon octicon-link"></span></a>6.1.3) Create aggregate measures (SUM).<a class="anchor-link" href="#6.1.3)-Create-aggregate-measures-(SUM)."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we calculate the sum of all values for the column <code>vistor_count</code> from the <code>visitation</code> table.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">" SELECT SUM(visitation.visitor_count) </span><span class="se">\</span>
<span class="s2">                 FROM visitation; "</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-ec8b5c9c-2423-42e7-b9c3-c3fc437bdddc">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>15431947</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ec8b5c9c-2423-42e7-b9c3-c3fc437bdddc')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ec8b5c9c-2423-42e7-b9c3-c3fc437bdddc button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ec8b5c9c-2423-42e7-b9c3-c3fc437bdddc');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.1.4)-Minimum,-Maximum-and-Average-Metrics.">
<a class="anchor" href="#6.1.4)-Minimum,-Maximum-and-Average-Metrics." aria-hidden="true"><span class="octicon octicon-link"></span></a>6.1.4) Minimum, Maximum and Average Metrics.<a class="anchor-link" href="#6.1.4)-Minimum,-Maximum-and-Average-Metrics."> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we calculate the minimum, average and maximum values for the column <code>vistor_count</code> from the <code>visitation</code> table.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT MIN(visitation.visitor_count), AVG(visitation.visitor_count), MAX(visitation.visitor_count) </span><span class="se">\</span>
<span class="s2">                FROM visitation;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-65c9d6fa-befa-42e0-8f0a-0af6aabd687d">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>min</th>
      <th>avg</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1409</td>
      <td>214332.597222222222</td>
      <td>398583</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-65c9d6fa-befa-42e0-8f0a-0af6aabd687d')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-65c9d6fa-befa-42e0-8f0a-0af6aabd687d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-65c9d6fa-befa-42e0-8f0a-0af6aabd687d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.1.5)-WHERE-and-ORDER-BY-command">
<a class="anchor" href="#6.1.5)-WHERE-and-ORDER-BY-command" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.1.5) WHERE and ORDER BY command<a class="anchor-link" href="#6.1.5)-WHERE-and-ORDER-BY-command"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>year</code> and <code>visitor_count</code> from the <code>visitation</code> table. The selection is limited to <code>visitor_count</code> values equal or greater than 300000. The results are organized by <code>year</code> in a descending order.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT visitation.year, visitation.visitor_count </span><span class="se">\</span>
<span class="s2">                FROM visitation WHERE visitation.visitor_count &gt;= 300000 </span><span class="se">\</span>
<span class="s2">                ORDER BY visitation.year </span><span class="se">\</span>
<span class="s2">                DESC;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-b97a27d3-37c2-4ce9-9f67-77b8ac2974b2">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>year</th>
      <th>visitor_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015</td>
      <td>381747</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014</td>
      <td>314102</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2013</td>
      <td>316953</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011</td>
      <td>361862</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2010</td>
      <td>372330</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b97a27d3-37c2-4ce9-9f67-77b8ac2974b2')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b97a27d3-37c2-4ce9-9f67-77b8ac2974b2 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b97a27d3-37c2-4ce9-9f67-77b8ac2974b2');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.1.6)-Summary">
<a class="anchor" href="#6.1.6)-Summary" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.1.6) Summary<a class="anchor-link" href="#6.1.6)-Summary"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following summary is provided in the second article that was referenced in part 1:</p>
<ul>
<li>
<code>SELECT</code> and <code>FROM</code> are the most essential parts of every query.</li>
<li>Selected data may request all <code>(*)</code>, specific columns or calculated values.</li>
<li>Formal referencing of data includes the sourcing table (table.data).</li>
<li>
<code>WHERE</code> is a valuable tool for filtering data for the desired output.</li>
<li>
<code>ORDER BY</code> sorts the query results, ascending <code>(ASC)</code> is the default.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.2)-FILTER-&amp;-GROUP-commands">
<a class="anchor" href="#6.2)-FILTER-&amp;-GROUP-commands" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.2) FILTER &amp; GROUP commands<a class="anchor-link" href="#6.2)-FILTER-&amp;-GROUP-commands"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Building on the basics of selecting desired data, add criteria to further refine the information retrieved for your report using conditional operators. These include command words such as <code>AND</code>, <code>OR</code>, <code>NOT</code>, <code>IN</code> and <code>BETWEEN</code>. They are added to the <code>SQL</code> query within the components of a <code>WHERE</code> clause, and are placed after the <code>SELECT</code> and <code>FROM</code> portions of the query. This structure will look like:</p>
<blockquote>
<p><strong>SELECT</strong> <em>(desired data here)</em> <br>
<strong>FROM</strong> <em>(table name here)</em> <br>
<strong>WHERE</strong> <em>(filtering criteria)</em></p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.2.1)-LIMIT-command">
<a class="anchor" href="#6.2.1)-LIMIT-command" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.2.1) LIMIT command<a class="anchor-link" href="#6.2.1)-LIMIT-command"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>location</code>, <code>number_of_households_in_1000</code> and <code>number_of_pet_households_in_1000</code> from the <code>animals</code> table. The selection is  are organized by <code>number_of_pet_households_in_1000</code> in a descending order. The display is limited to the 10 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT animals.location, animals.number_of_households_in_1000, animals.number_of_pet_households_in_1000 </span><span class="se">\</span>
<span class="s2">                FROM animals </span><span class="se">\</span>
<span class="s2">                ORDER BY animals.number_of_pet_households_in_1000 </span><span class="se">\</span>
<span class="s2">                DESC </span><span class="se">\</span>
<span class="s2">                LIMIT 10;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-b0185b38-fd90-4812-bc62-b3cccc21064e">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>location</th>
      <th>number_of_households_in_1000</th>
      <th>number_of_pet_households_in_1000</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>California</td>
      <td>12974</td>
      <td>6865</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Texas</td>
      <td>9002</td>
      <td>5265</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Florida</td>
      <td>7609</td>
      <td>4138</td>
    </tr>
    <tr>
      <th>3</th>
      <td>New York</td>
      <td>7512</td>
      <td>3802</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pennsylvania</td>
      <td>5172</td>
      <td>2942</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Ohio</td>
      <td>4661</td>
      <td>2677</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Illinois</td>
      <td>5026</td>
      <td>2602</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Michigan</td>
      <td>3804</td>
      <td>2108</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Georgia</td>
      <td>3798</td>
      <td>2093</td>
    </tr>
    <tr>
      <th>9</th>
      <td>North Carolina</td>
      <td>3701</td>
      <td>2089</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b0185b38-fd90-4812-bc62-b3cccc21064e')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b0185b38-fd90-4812-bc62-b3cccc21064e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b0185b38-fd90-4812-bc62-b3cccc21064e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.2.2)-Multiple-WHERE-commands">
<a class="anchor" href="#6.2.2)-Multiple-WHERE-commands" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.2.2) Multiple WHERE commands<a class="anchor-link" href="#6.2.2)-Multiple-WHERE-commands"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>location</code>, <code>mean_number_of_dogs_per_household</code> and <code>mean_number_of_cats</code> from the <code>animals</code> table. The selection considers <code>mean_number_of_dogs_per_household</code> and <code>mean_number_of_cats</code> equal or greater than 2. The results are organized by <code>location</code>. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT animals.location, animals.mean_number_of_dogs_per_household, animals.mean_number_of_cats </span><span class="se">\</span>
<span class="s2">                FROM animals </span><span class="se">\</span>
<span class="s2">                WHERE animals.mean_number_of_dogs_per_household &gt;= 2 AND animals.mean_number_of_cats &gt;= 2 </span><span class="se">\</span>
<span class="s2">                ORDER BY animals.location </span><span class="se">\</span>
<span class="s2">                LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-a198e565-97b6-4556-b644-48de5e0a1c5e">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>location</th>
      <th>mean_number_of_dogs_per_household</th>
      <th>mean_number_of_cats</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arkansas</td>
      <td>2.000</td>
      <td>2.300</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New Mexico</td>
      <td>2.000</td>
      <td>2.200</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Oklahoma</td>
      <td>2.100</td>
      <td>2.200</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a198e565-97b6-4556-b644-48de5e0a1c5e')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a198e565-97b6-4556-b644-48de5e0a1c5e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a198e565-97b6-4556-b644-48de5e0a1c5e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.2.3)-BETWEEN-command">
<a class="anchor" href="#6.2.3)-BETWEEN-command" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.2.3) BETWEEN command<a class="anchor-link" href="#6.2.3)-BETWEEN-command"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>location</code>, <code>mean_number_of_cats</code> and <code>cat_population</code> from the <code>animals</code> table. The selection considers <code>mean_number_of_cats</code> between 2.2 and 4. The results are organized by <code>cat_population</code>. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT animals.location, animals.mean_number_of_cats, animals.cat_population </span><span class="se">\</span>
<span class="s2">                FROM animals </span><span class="se">\</span>
<span class="s2">                WHERE animals.mean_number_of_cats </span><span class="se">\</span>
<span class="s2">                BETWEEN 2.2 AND 4 </span><span class="se">\</span>
<span class="s2">                ORDER BY animals.cat_population </span><span class="se">\</span>
<span class="s2">                DESC </span><span class="se">\</span>
<span class="s2">                LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-c5c8659a-e0cc-4c52-be3c-ca8334126e51">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>location</th>
      <th>mean_number_of_cats</th>
      <th>cat_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Texas</td>
      <td>2.200</td>
      <td>5565</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ohio</td>
      <td>2.400</td>
      <td>3786</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Indiana</td>
      <td>2.200</td>
      <td>1912</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c5c8659a-e0cc-4c52-be3c-ca8334126e51')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c5c8659a-e0cc-4c52-be3c-ca8334126e51 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c5c8659a-e0cc-4c52-be3c-ca8334126e51');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.2.4)-AS-command">
<a class="anchor" href="#6.2.4)-AS-command" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.2.4) AS command<a class="anchor-link" href="#6.2.4)-AS-command"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>region</code> together with the sums of <code>number_of_pet_households_in_1000</code>, <code>dog_population_in_1000</code>,  <code>cat_population</code> and the sum of the last two sums from the <code>animals</code> table grouped by <code>region</code>. These sum variables were named <code>total_pet_households</code>, <code>dog_total</code>, <code>cat_total</code> and <code>total_companion_pets</code>.  The results are organized by <code>total_pet_households</code> in a descending order. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">" SELECT animals.region, SUM(animals.number_of_pet_households_in_1000) AS total_pet_households, SUM(animals.dog_population_in_1000) AS dog_total, </span><span class="se">\</span>
<span class="s2">                 SUM(animals.cat_population) AS cat_total, (SUM(animals.dog_population_in_1000) + SUM(animals.cat_population)) AS total_companion_pets </span><span class="se">\</span>
<span class="s2">                 FROM animals </span><span class="se">\</span>
<span class="s2">                 GROUP BY animals.region </span><span class="se">\</span>
<span class="s2">                 ORDER BY total_pet_households</span><span class="se">\</span>
<span class="s2">                 DESC </span><span class="se">\</span>
<span class="s2">                 LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-8d5ce45e-1412-444b-bf67-c25c9c3fc747">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>region</th>
      <th>total_pet_households</th>
      <th>dog_total</th>
      <th>cat_total</th>
      <th>total_companion_pets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Central</td>
      <td>18438</td>
      <td>20677</td>
      <td>20332</td>
      <td>41009</td>
    </tr>
    <tr>
      <th>1</th>
      <td>South</td>
      <td>16886</td>
      <td>20253</td>
      <td>18356</td>
      <td>38609</td>
    </tr>
    <tr>
      <th>2</th>
      <td>East</td>
      <td>15991</td>
      <td>13549</td>
      <td>19256</td>
      <td>32805</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-8d5ce45e-1412-444b-bf67-c25c9c3fc747')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-8d5ce45e-1412-444b-bf67-c25c9c3fc747 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-8d5ce45e-1412-444b-bf67-c25c9c3fc747');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.2.5)-GROUP-BY-+-HAVING-command">
<a class="anchor" href="#6.2.5)-GROUP-BY-+-HAVING-command" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.2.5) GROUP BY + HAVING command<a class="anchor-link" href="#6.2.5)-GROUP-BY-+-HAVING-command"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>region</code> and <code>AVG(percentage_of_households_with_pets)</code> from the <code>animals</code> table grouped by <code>region</code>. Notice that we keep the regions with an <code>AVG(percentage_of_households_with_pets)</code> greater than 55. <strong>Thus, HAVING is used with the GROUP BY command</strong>. The results are organized by <code>region</code> in a descending order. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">" SELECT animals.region, AVG(animals.percentage_of_households_with_pets) </span><span class="se">\</span>
<span class="s2">                 FROM animals </span><span class="se">\</span>
<span class="s2">                 GROUP BY animals.region HAVING AVG(animals.percentage_of_households_with_pets) &gt; 55 </span><span class="se">\</span>
<span class="s2">                 ORDER BY animals.region </span><span class="se">\</span>
<span class="s2">                 DESC </span><span class="se">\</span>
<span class="s2">                 LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-97a3bbc0-bb5e-4525-8bed-c8e34743a351">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>region</th>
      <th>avg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>West</td>
      <td>59.9545454545454545</td>
    </tr>
    <tr>
      <th>1</th>
      <td>South</td>
      <td>57.0909090909090909</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Central</td>
      <td>57.0615384615384615</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-97a3bbc0-bb5e-4525-8bed-c8e34743a351')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-97a3bbc0-bb5e-4525-8bed-c8e34743a351 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-97a3bbc0-bb5e-4525-8bed-c8e34743a351');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.2.6)-Summary">
<a class="anchor" href="#6.2.6)-Summary" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.2.6) Summary<a class="anchor-link" href="#6.2.6)-Summary"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following summary is provided in the second article that was referenced in part 1:</p>
<ul>
<li>
<code>WHERE</code> provides an opportunity to narrow the criteria for queries.</li>
<li>Filters may be created with a variety of conditional commands.</li>
<li>Compound conditional filters may be used in queries.</li>
<li>
<code>GROUP BY</code> aggregates information based on categorical dimensions.</li>
<li>
<code>HAVING</code> criteria may be applied to the groups that are aggregated.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.3)-Aggregating-and-Grouping-Data">
<a class="anchor" href="#6.3)-Aggregating-and-Grouping-Data" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.3) Aggregating and Grouping Data<a class="anchor-link" href="#6.3)-Aggregating-and-Grouping-Data"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Aggregation SQL functions bring clarity and depth to queries, which include <code>DISTINCT</code>, <code>COUNT</code>, <code>GROUP BY</code> and <code>HAVING</code>. These commands add to the filtering accomplished by the <code>WHERE</code> clause, and enable viewing data in groups, segments or other organized levels. <code>DISTINCT</code> and <code>COUNT</code> are often used in the <code>SELECT</code> statement to create and quantify aggregation. By contrast, <code>GROUP BY</code> and <code>HAVING</code> are placed after the <code>WHERE</code> clause. As you consider using these tools in your query, it is important to be consistent in the level of aggregation requested in one query. The following shows the appropriate order for the command tools in your new query:</p>
<blockquote>
<p><strong>SELECT DISTINCT</strong> <em>(desired column list)</em> <br>
<strong>FROM</strong> <em>(table name here)</em> <br>
<strong>WHERE</strong> <em>(filtering criteria)</em> <br>
<strong>GROUP BY</strong> <em>(data_name)</em> <strong>HAVING</strong> <em>(additional filter)</em></p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.3.1)-DISTINCT,-ROUND,-COUNT-and-Multiple-GROUP-BY-commmands">
<a class="anchor" href="#6.3.1)-DISTINCT,-ROUND,-COUNT-and-Multiple-GROUP-BY-commmands" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.3.1) DISTINCT, ROUND, COUNT and Multiple GROUP BY commmands<a class="anchor-link" href="#6.3.1)-DISTINCT,-ROUND,-COUNT-and-Multiple-GROUP-BY-commmands"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>item</code>, <code>description</code>,  <code>qty_sold</code>,  <code>avg_transaction_price</code> and <code>total_sold</code> from the <code>products</code> table. Notice that the last 3 variables mentioned above refer to <code>COUNT(sales.item)</code>, <code>ROUND(AVG(sales.total),2)</code> and <code>avg_transaction_price</code>. The analysis is limited to unique combinations of items and descriptions. The selected variables were grouped by <code>item</code> and then <code>description</code>. The results are organized by <code>qty_sold</code> in a descending order. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT DISTINCT sales.item, sales.description, COUNT(sales.item) as qty_sold, </span><span class="se">\</span>
<span class="s2">                ROUND(AVG(sales.total),2) as avg_transaction_price, SUM(sales.total) as total_sold </span><span class="se">\</span>
<span class="s2">                FROM sales </span><span class="se">\</span>
<span class="s2">                GROUP BY sales.item, sales.description </span><span class="se">\</span>
<span class="s2">                ORDER BY qty_sold </span><span class="se">\</span>
<span class="s2">                DESC </span><span class="se">\</span>
<span class="s2">                LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-5d017793-7c77-4387-ac12-c713b68a1a39">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>item</th>
      <th>description</th>
      <th>qty_sold</th>
      <th>avg_transaction_price</th>
      <th>total_sold</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11788</td>
      <td>Black Velvet</td>
      <td>31904</td>
      <td>403.19</td>
      <td>12863376.81</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36308</td>
      <td>Hawkeye Vodka</td>
      <td>31105</td>
      <td>172.99</td>
      <td>5380753.20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>43336</td>
      <td>Captain Morgan Original Spiced</td>
      <td>18129</td>
      <td>192.94</td>
      <td>3497803.08</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5d017793-7c77-4387-ac12-c713b68a1a39')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5d017793-7c77-4387-ac12-c713b68a1a39 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5d017793-7c77-4387-ac12-c713b68a1a39');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>county</code>, <code>qty_sold</code> and <code>total_sold</code> from the <code>sales</code> table. Notice that the last 2 variables mentioned above refer to <code>COUNT(sales.item)</code> and <code>SUM(sales.total)</code>. The analysis is limited to unique county names. Moreover, the description columns must be either 'Black Velvet' or 'Hawkeye Vodka'. The aggregate measure were created by groupbing the table by county if the item count per group exceeded 10000. The results are organized by <code>total_sold</code> in a descending order. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.3.2)-IN-commmand">
<a class="anchor" href="#6.3.2)-IN-commmand" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.3.2) IN commmand<a class="anchor-link" href="#6.3.2)-IN-commmand"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>county</code>, <code>qty_sold</code> and <code>total_sold</code> from the <code>products</code> table. Notice that the last 2 variables mentioned above refer to <code>COUNT(sales.item)</code> and <code>SUM(sales.total)</code>. The selected variables were grouped by <code>county</code> when the count of items was greater than 10000. The results are organized by <code>total_sold</code> in a descending order. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT DISTINCT sales.county, COUNT(sales.item) as qty_sold, SUM(sales.total) as total_sold </span><span class="se">\</span>
<span class="s2">                FROM sales </span><span class="se">\</span>
<span class="s2">                WHERE sales.description IN('Black Velvet', 'Hawkeye Vodka') </span><span class="se">\</span>
<span class="s2">                GROUP BY sales.county HAVING (COUNT(sales.item)) &gt; 10000 </span><span class="se">\</span>
<span class="s2">                ORDER BY total_sold </span><span class="se">\</span>
<span class="s2">                DESC </span><span class="se">\</span>
<span class="s2">                LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-f8c2692c-de37-4726-b084-fac6e101ab6c">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>county</th>
      <th>qty_sold</th>
      <th>total_sold</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Polk</td>
      <td>28058</td>
      <td>4114463.32</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Linn</td>
      <td>12746</td>
      <td>2366315.91</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f8c2692c-de37-4726-b084-fac6e101ab6c')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f8c2692c-de37-4726-b084-fac6e101ab6c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f8c2692c-de37-4726-b084-fac6e101ab6c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Notice that you cannot replace (COUNT(sales.item)) by qty_sold</strong> after the HAVING command since it is considered part of the GROUP BY command. Since this command is not "over", the variable qty_sold does not exist yet. However, once the GROUP BY + HAVING commands are used, the variable total_sold can be used in the ORDER BY command.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.3.3)-COUNT(*)-and-CAST-commmands">
<a class="anchor" href="#6.3.3)-COUNT(*)-and-CAST-commmands" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.3.3) COUNT(*) and CAST commmands<a class="anchor-link" href="#6.3.3)-COUNT(*)-and-CAST-commmands"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>vendor_name</code>, <code>products_offered</code> and <code>avg_price</code> from the <code>products</code> table. Notice that the last 2 variables mentioned above refer to the count of all instances using <code>COUNT(*)</code> and the rounded average of the feature <code>bottle_price</code>. The selected variables were grouped by <code>vendor_name</code>. The results are organized by <code>products_offered</code> in a descending order. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT products.vendor_name, COUNT(*) AS products_offered, ROUND(AVG(CAST(products.bottle_price AS DECIMAL)),2) AS avg_price </span><span class="se">\</span>
<span class="s2">                FROM products </span><span class="se">\</span>
<span class="s2">                GROUP BY products.vendor_name </span><span class="se">\</span>
<span class="s2">                ORDER BY products_offered </span><span class="se">\</span>
<span class="s2">                DESC </span><span class="se">\</span>
<span class="s2">                LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-7a19125e-96ee-427a-aac8-8fb79d5b9a4e">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>vendor_name</th>
      <th>products_offered</th>
      <th>avg_price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim Beam Brands</td>
      <td>925</td>
      <td>11.54</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Diageo Americas</td>
      <td>906</td>
      <td>18.16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Pernod Ricard Usa/austin Nichols</td>
      <td>597</td>
      <td>19.80</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7a19125e-96ee-427a-aac8-8fb79d5b9a4e')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-7a19125e-96ee-427a-aac8-8fb79d5b9a4e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-7a19125e-96ee-427a-aac8-8fb79d5b9a4e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>The CAST command is required so that the bottle price can be use without the monetary sign ($).</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.3.4)-LEFT-JOIN-+-USING-commands">
<a class="anchor" href="#6.3.4)-LEFT-JOIN-+-USING-commands" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.3.4) LEFT JOIN + USING commands<a class="anchor-link" href="#6.3.4)-LEFT-JOIN-+-USING-commands"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>county</code>, <code>population</code>,  <code>qty_sold</code> and <code>total_sold</code> from the join of the <code>sales</code> and <code>counties</code> tables using the <code>county</code> column. Notice that the last 2 variables mentioned above refer to <code>COUNT(sales.item)</code> and <code>SUM(sales.total)</code>. The analysis is limited to unique combinations of counties and population. The selected variables were grouped by <code>county</code> and then <code>population</code>, when the county population exceeded 150000. The results are organized by <code>total_sold</code> in a descending order. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">" SELECT DISTINCT sales.county, counties.population, COUNT(sales.item) as qty_sold, SUM(sales.total) as total_sold </span><span class="se">\</span>
<span class="s2">                 FROM sales LEFT JOIN counties USING(county) </span><span class="se">\</span>
<span class="s2">                 WHERE description IN('Black Velvet', 'Hawkeye Vodka') </span><span class="se">\</span>
<span class="s2">                 GROUP BY sales.county, counties.population HAVING counties.population &gt; 150000 </span><span class="se">\</span>
<span class="s2">                 ORDER BY total_sold DESC </span><span class="se">\</span>
<span class="s2">                 LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-8de53086-4b04-49a6-be43-13fe7a8c68c2">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>county</th>
      <th>population</th>
      <th>qty_sold</th>
      <th>total_sold</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Polk</td>
      <td>430640</td>
      <td>28058</td>
      <td>4114463.32</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Linn</td>
      <td>211226</td>
      <td>12746</td>
      <td>2366315.91</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Scott</td>
      <td>165224</td>
      <td>5471</td>
      <td>732618.98</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-8de53086-4b04-49a6-be43-13fe7a8c68c2')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-8de53086-4b04-49a6-be43-13fe7a8c68c2 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-8de53086-4b04-49a6-be43-13fe7a8c68c2');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that there will always be unique combinations of counties and populations since any given county only has one population value. In other types of examples, the constraint of finding unique combinations of variables might be an issue that requires more thought.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.3.5)-LEFT-JOIN-+-ON-commands">
<a class="anchor" href="#6.3.5)-LEFT-JOIN-+-ON-commands" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.3.5) LEFT JOIN + ON commands<a class="anchor-link" href="#6.3.5)-LEFT-JOIN-+-ON-commands"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we have the very same example as the previous query. However, we use <code>ON</code> instead of <code>USING</code> as a command.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">" SELECT DISTINCT sales.county, counties.population, COUNT(sales.item) as qty_sold, SUM(sales.total) as total_sold </span><span class="se">\</span>
<span class="s2">                 FROM sales LEFT JOIN counties ON sales.county = counties.county </span><span class="se">\</span>
<span class="s2">                 WHERE description IN('Black Velvet', 'Hawkeye Vodka') </span><span class="se">\</span>
<span class="s2">                 GROUP BY sales.county, counties.population </span><span class="se">\</span>
<span class="s2">                 HAVING counties.population &gt; 150000 </span><span class="se">\</span>
<span class="s2">                 ORDER BY total_sold DESC </span><span class="se">\</span>
<span class="s2">                 LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-3dd6693e-8288-4bea-a3a8-0dd32441e518">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>county</th>
      <th>population</th>
      <th>qty_sold</th>
      <th>total_sold</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Polk</td>
      <td>430640</td>
      <td>28058</td>
      <td>4114463.32</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Linn</td>
      <td>211226</td>
      <td>12746</td>
      <td>2366315.91</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Scott</td>
      <td>165224</td>
      <td>5471</td>
      <td>732618.98</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-3dd6693e-8288-4bea-a3a8-0dd32441e518')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-3dd6693e-8288-4bea-a3a8-0dd32441e518 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-3dd6693e-8288-4bea-a3a8-0dd32441e518');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.3.6)-NOT-IN-command">
<a class="anchor" href="#6.3.6)-NOT-IN-command" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.3.6) NOT IN command<a class="anchor-link" href="#6.3.6)-NOT-IN-command"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>county</code>, <code>qty_sold</code> and <code>total_sold</code> from the <code>sales</code> table. Notice that the last 2 variables mentioned above refer to <code>COUNT(sales.item)</code> and <code>SUM(sales.total)</code>. The analysis is limited to unique combinations of counties considering descriptions that include neither 'Black Velvet' nor 'Hawkeye Vodka' and considering the counties of 'Polk', 'Linn', 'Scott' . The selected variables were grouped by <code>county</code>. The results are organized by <code>total_sold</code> in a descending order. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">" SELECT DISTINCT sales.county, COUNT(sales.item) as qty_sold, SUM(sales.total) as total_sold </span><span class="se">\</span>
<span class="s2">                 FROM sales </span><span class="se">\</span>
<span class="s2">                 WHERE sales.description NOT IN('Black Velvet','Hawkeye Vodka') </span><span class="se">\</span>
<span class="s2">                 AND sales.county IN('Polk', 'Linn', 'Scott') </span><span class="se">\</span>
<span class="s2">                 GROUP BY sales.county </span><span class="se">\</span>
<span class="s2">                 ORDER BY total_sold </span><span class="se">\</span>
<span class="s2">                 DESC </span><span class="se">\</span>
<span class="s2">                 LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-9dcc8738-518c-44e1-b65e-d6b02641454c">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>county</th>
      <th>qty_sold</th>
      <th>total_sold</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Polk</td>
      <td>533688</td>
      <td>82282998.47</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Linn</td>
      <td>238524</td>
      <td>32093731.58</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Scott</td>
      <td>182849</td>
      <td>27170229.69</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9dcc8738-518c-44e1-b65e-d6b02641454c')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9dcc8738-518c-44e1-b65e-d6b02641454c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9dcc8738-518c-44e1-b65e-d6b02641454c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.3.7)-Summary">
<a class="anchor" href="#6.3.7)-Summary" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.3.7) Summary<a class="anchor-link" href="#6.3.7)-Summary"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following summary is provided in the second article that was referenced in part 1:</p>
<ul>
<li>
<code>DISTINCT</code> and <code>GROUP BY</code> provide insights into aggregated slices of the data.</li>
<li>
<code>COUNTing</code> the quantity of a group member can provide valuable insight.</li>
<li>Compound conditions can be joined by <code>AND</code> in queries.</li>
<li>
<code>HAVING</code> further filters aggregated data, in addition to filtering applied to raw data by the <code>WHERE</code> clause.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.4)-JOIN-command">
<a class="anchor" href="#6.4)-JOIN-command" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.4) JOIN command<a class="anchor-link" href="#6.4)-JOIN-command"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just as we organize belongings into separate storage areas, data needed for analysis is often stored in multiple locations. SQL enables you to easily combine data from multiple resources, if you have a unique identifier to bridge between the data tables. Connecting data sources is established with the <code>FROM</code> clause, identifying the source tables and the fields which are candidates for the unique connection. Weâ€™ll begin with the <code>INNER JOIN</code>, which returns only the records that match exactly from both tables. The basic command frame for the <code>SELECT</code> statement remains the same, with some new additions. When referencing columns within a <code>JOIN</code> query, use the formal labeling for column names, meaning table name together with column name separated by a period, for clear identification. The structure to <code>JOIN</code> two tables within the <code>FROM</code> clause is accomplished as follows:</p>
<blockquote>
<p><strong>FROM</strong> <em>(primary table name here)</em> <br>
<strong>INNER JOIN</strong> <em>(secondary table here)</em> <br>
<strong>ON</strong> <em>(primary_table.field_from_primary = secondary_table.field_from_secondary)</em></p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.4.1)-INNER-JOIN-command">
<a class="anchor" href="#6.4.1)-INNER-JOIN-command" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.4.1) INNER JOIN command<a class="anchor-link" href="#6.4.1)-INNER-JOIN-command"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>store_number</code>, <code>name</code>, <code>store_address</code> and <code>total_sold</code> from the join of the <code>sales2016</code> and <code>stores</code> tables. Notice that the last variable mentioned above refers to <code>SUM(sales2016.sale_dollars)</code>.  The <code>INNER JOIN</code> command used the columns <code>store_number</code> and <code>store</code> to merge the tables. The selected variables were grouped by <code>store_number</code>, <code>name</code> and <code>store_address</code>. The results are organized by <code>total_sold</code> in a descending order. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT sales_2016.store_number, stores.name, stores.store_address, SUM(sales_2016.sale_dollars) AS total_sold </span><span class="se">\</span>
<span class="s2">                FROM sales_2016 </span><span class="se">\</span>
<span class="s2">                INNER JOIN stores ON sales_2016.store_number = stores.store </span><span class="se">\</span>
<span class="s2">                GROUP BY sales_2016.store_number, stores.name, stores.store_address </span><span class="se">\</span>
<span class="s2">                ORDER BY total_sold </span><span class="se">\</span>
<span class="s2">                DESC </span><span class="se">\</span>
<span class="s2">                LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-ebba77fe-04e6-4fc4-ab3f-40cd39a1ff11">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>store_number</th>
      <th>name</th>
      <th>store_address</th>
      <th>total_sold</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2633</td>
      <td>Hy-vee #3 / Bdi / Des Moines</td>
      <td>3221 Se 14th St\nDes Moines, IA 503200000\n(41...</td>
      <td>7904425.39</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4829</td>
      <td>Central City 2</td>
      <td>1501 Michigan Ave\nDes Moines, IA 50314\n(41.6...</td>
      <td>7156755.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2512</td>
      <td>Hy-vee Wine and Spirits / Iowa City</td>
      <td>1720 Waterfront Dr\nIowa City, IA 522400000\n(...</td>
      <td>3400203.01</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ebba77fe-04e6-4fc4-ab3f-40cd39a1ff11')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ebba77fe-04e6-4fc4-ab3f-40cd39a1ff11 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ebba77fe-04e6-4fc4-ab3f-40cd39a1ff11');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.4.2)-Divide-one-column-by-another-(feature-creation)">
<a class="anchor" href="#6.4.2)-Divide-one-column-by-another-(feature-creation)" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.4.2) Divide one column by another (feature creation)<a class="anchor-link" href="#6.4.2)-Divide-one-column-by-another-(feature-creation)"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>county</code>, <code>total_sold</code>, <code>population</code> and <code>per_capita_spend</code> from the join of the <code>sales2016</code> and <code>counties</code> tables. Notice that the the variables <code>total_sold</code> and <code>per_capita_spend</code> mentioned above refer to <code>SUM(sales2016.sale_dollars)</code> and <code>ROUND((SUM(sales2016.sale_dollars)/(counties.population)),2)</code>.  The <code>INNER JOIN</code> command used the column <code>county</code> to merge the tables. The selected variables were grouped by <code>county</code> and <code>population</code>. The results are organized by <code>per_capita_spend</code> in a descending order. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT sales_2016.county, SUM(sales_2016.sale_dollars) AS total_sold, counties.population, </span><span class="se">\</span>
<span class="s2">                ROUND((SUM(sales_2016.sale_dollars)/(counties.population)),2) AS per_capita_spend </span><span class="se">\</span>
<span class="s2">                FROM sales_2016 </span><span class="se">\</span>
<span class="s2">                INNER JOIN counties USING(county) </span><span class="se">\</span>
<span class="s2">                GROUP BY sales_2016.county, counties.population </span><span class="se">\</span>
<span class="s2">                ORDER BY per_capita_spend </span><span class="se">\</span>
<span class="s2">                DESC </span><span class="se">\</span>
<span class="s2">                LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-ec9e1df7-559a-4f7c-93e0-222f27dd4e39">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>county</th>
      <th>total_sold</th>
      <th>population</th>
      <th>per_capita_spend</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Dickinson</td>
      <td>3112712.41</td>
      <td>16667</td>
      <td>186.76</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Polk</td>
      <td>42400328.31</td>
      <td>430640</td>
      <td>98.46</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cerro Gordo</td>
      <td>3617023.05</td>
      <td>44151</td>
      <td>81.92</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ec9e1df7-559a-4f7c-93e0-222f27dd4e39')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ec9e1df7-559a-4f7c-93e0-222f27dd4e39 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ec9e1df7-559a-4f7c-93e0-222f27dd4e39');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.4.3)-COUNT-+-DISTINCT-commands">
<a class="anchor" href="#6.4.3)-COUNT-+-DISTINCT-commands" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.4.3) COUNT + DISTINCT commands<a class="anchor-link" href="#6.4.3)-COUNT-+-DISTINCT-commands"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>county</code>, <code>qty_stores</code>, <code>total_sales</code>, <code>county_population</code> and <code>num_people_per_store</code> from the join of the <code>sales_2016</code> and <code>counties</code> tables. Notice that the the variables <code>qty_stores</code>, <code>total_sales</code> and <code>num_people_per_store</code> mentioned above refer to <code>COUNT(DISTINCT sales_2016.store_number)</code>, <code>SUM(sales_2016.sale_dollars)</code> and <code>(counties.population/(COUNT(DISTINCT sales_2016.store_number)))</code>.  The <code>INNER JOIN</code> command used the column <code>county</code> to merge the tables. Notice that the selection is limited to the counties of 'Dickinson', 'Polk', 'Johnson' and 'Cerro Gordo'. The selected variables were grouped by <code>county</code> and then <code>population</code>. The results are organized by <code>total_sales</code> in a descending order. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT sales_2016.county, COUNT(DISTINCT sales_2016.store_number) AS qty_stores, SUM(sales_2016.sale_dollars) AS total_sales, </span><span class="se">\</span>
<span class="s2">                counties.population AS county_population, (counties.population/(COUNT(DISTINCT sales_2016.store_number))) AS num_people_per_store </span><span class="se">\</span>
<span class="s2">                FROM sales_2016 INNER JOIN counties USING(county) </span><span class="se">\</span>
<span class="s2">                WHERE sales_2016.county IN('Dickinson', 'Polk', 'Johnson', 'Cerro Gordo' ) </span><span class="se">\</span>
<span class="s2">                GROUP BY sales_2016.county, counties.population </span><span class="se">\</span>
<span class="s2">                ORDER BY total_sales DESC </span><span class="se">\</span>
<span class="s2">                LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-749b35d6-0e52-4b0a-bb32-9b405ee63947">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>county</th>
      <th>qty_stores</th>
      <th>total_sales</th>
      <th>county_population</th>
      <th>num_people_per_store</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Polk</td>
      <td>188</td>
      <td>42400328.31</td>
      <td>430640</td>
      <td>2290</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Johnson</td>
      <td>50</td>
      <td>10509392.26</td>
      <td>130882</td>
      <td>2617</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cerro Gordo</td>
      <td>20</td>
      <td>3617023.05</td>
      <td>44151</td>
      <td>2207</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-749b35d6-0e52-4b0a-bb32-9b405ee63947')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-749b35d6-0e52-4b0a-bb32-9b405ee63947 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-749b35d6-0e52-4b0a-bb32-9b405ee63947');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.4.4)-IS-NOT-NULL-command">
<a class="anchor" href="#6.4.4)-IS-NOT-NULL-command" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.4.4) IS NOT NULL command<a class="anchor-link" href="#6.4.4)-IS-NOT-NULL-command"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we select the columns <code>county</code>, <code>store_number</code>, <code>store_name</code>, <code>qty_sold</code>, <code>avg_sale_price</code> and <code>total_sold</code> from the join of the <code>sales_2016</code> and <code>convenience</code> tables. Notice that the the 3 lasts variables mentioned above refer to <code>COUNT(sales_2016.sale_dollars)</code>, <code>ROUND(AVG(sales_2016.sale_dollars),2)</code> and <code>SUM(sales_2016.sale_dollars)</code>.  The <code>INNER JOIN</code> command used the columns <code>store_numbers</code> and <code>store</code> to merge the tables. Notice that the selection is limited stores values that are not NULL and to the counties of 'Dickinson', 'Polk' and 'Johnson'. The selected variables were grouped by <code>county</code>, <code>store_number</code> and <code>store_names</code>. The results are organized by <code>county</code> and then <code>total_sold</code> in a descending order. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">" SELECT sales_2016.county, sales_2016.store_number, sales_2016.store_name, COUNT(sales_2016.sale_dollars) AS qty_sold, </span><span class="se">\</span>
<span class="s2">                 ROUND(AVG(sales_2016.sale_dollars),2) AS avg_sale_price, SUM(sales_2016.sale_dollars) AS total_sold </span><span class="se">\</span>
<span class="s2">                 FROM sales_2016 </span><span class="se">\</span>
<span class="s2">                 INNER JOIN convenience ON sales_2016.store_number = convenience.store </span><span class="se">\</span>
<span class="s2">                 WHERE convenience.store IS NOT NULL AND sales_2016.county IN('Johnson','Dickinson', 'Polk') </span><span class="se">\</span>
<span class="s2">                 GROUP BY sales_2016.county, sales_2016.store_number, sales_2016.store_name </span><span class="se">\</span>
<span class="s2">                 ORDER BY sales_2016.county, total_sold </span><span class="se">\</span>
<span class="s2">                 DESC </span><span class="se">\</span>
<span class="s2">                 LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-c0788904-8f01-455f-baac-bfef2d8688ef">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>county</th>
      <th>store_number</th>
      <th>store_name</th>
      <th>qty_sold</th>
      <th>avg_sale_price</th>
      <th>total_sold</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Dickinson</td>
      <td>4576</td>
      <td>THE BOONEDOCKS</td>
      <td>823</td>
      <td>92.26</td>
      <td>75929.34</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Dickinson</td>
      <td>4582</td>
      <td>Pronto / Spirit Lake</td>
      <td>634</td>
      <td>89.43</td>
      <td>56698.15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Dickinson</td>
      <td>4387</td>
      <td>KUM &amp; GO #117 / SPIRIT LAKE</td>
      <td>293</td>
      <td>99.13</td>
      <td>29045.78</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c0788904-8f01-455f-baac-bfef2d8688ef')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c0788904-8f01-455f-baac-bfef2d8688ef button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c0788904-8f01-455f-baac-bfef2d8688ef');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.4.5)-CASE-+-COALESCE-commands">
<a class="anchor" href="#6.4.5)-CASE-+-COALESCE-commands" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.4.5) CASE + COALESCE commands<a class="anchor-link" href="#6.4.5)-CASE-+-COALESCE-commands"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We begin the query by considering the column store_address. We get the position of the term "IA". Then, we consider that if the position 3 string to the right of IA plus 1 position is smaller than '1', then this value should be considered as 'no zip'. Notice that this statement is useful in the case of "Dehner Distillery" where no zip code is available. Instead, in this case, we have "\n" following the word IA. Since "\n" is smaller than "1", then we have 'no zip' associated with this situation. In other cases, such as when the name is 'Louisiana Spirits LLC', then there is a zip number. This number goes from 3 positions to the right of "IA" up until (3 + 5) positions to the right of "IA". In usch circumstances, the value extracted is the zip code number. These values are saved in column called zipcode. <br></p>
<p>Other columns are also selected. including <code>name</code>, <code>store_id</code> and <code>store_status</code>. Another piece of information is also extracted from the store_address column by considering the first string up until 1 position to the right of "IA". This piece of information corresponds to the street address. <code>COALESCE</code> is used to get the first non-null argument. <br></p>
<p>Here we selection is made from the join of the <code>stores</code> and <code>sales</code> tables. The <code>LEFT JOIN</code> command used the column <code>store</code>. Notice that the selection is limited to instances with store_status equal to "A" and total sales equal to null. The results are organized by <code>zipcode</code> in a descending order. The display is limited to the 3 first rows.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">,</span> <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="s1">'tfio_demo'</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create SQL query</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">" SELECT CASE WHEN SUBSTRING(store_address,(POSITION('IA' in stores.store_address)+3),1) &lt; '1' THEN 'no zip' </span><span class="se">\</span>
<span class="s2">                 ELSE SUBSTRING(store_address,(POSITION('IA' in stores.store_address)+3),5) END AS zipcode, </span><span class="se">\</span>
<span class="s2">                 stores.name, stores.store AS store_id, store_status, </span><span class="se">\</span>
<span class="s2">                 SUBSTRING(store_address,1,(POSITION('IA' in stores.store_address)+1)) AS st_address, </span><span class="se">\</span>
<span class="s2">                 COALESCE(sales.total, 0) AS sales_totals </span><span class="se">\</span>
<span class="s2">                 FROM stores LEFT JOIN sales USING (store) </span><span class="se">\</span>
<span class="s2">                 WHERE store_status = 'A' AND sales.total IS NULL </span><span class="se">\</span>
<span class="s2">                 ORDER BY zipcode </span><span class="se">\</span>
<span class="s2">                 DESC </span><span class="se">\</span>
<span class="s2">                 LIMIT 3;"</span><span class="p">)</span>
<span class="n">table_contacts</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Turn the results of the query into a dataframe for visualization of the results</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">table_contacts</span><span class="p">)</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

  <div id="df-09d5859f-fee4-4017-a8eb-882ef114eb9d">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>zipcode</th>
      <th>name</th>
      <th>store_id</th>
      <th>store_status</th>
      <th>st_address</th>
      <th>sales_totals</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>no zip</td>
      <td>Dehner Distillery</td>
      <td>9919</td>
      <td>A</td>
      <td>7500, University Ave\nClive, IA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>70650</td>
      <td>Louisiana Spirits LLC</td>
      <td>9920</td>
      <td>A</td>
      <td>20909, South I-10 Frontage Rd\nLacassine, IA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>52804</td>
      <td>Sub Xpress &amp; Gas</td>
      <td>4526</td>
      <td>A</td>
      <td>4307 W Locust St\nDavenport, IA</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-09d5859f-fee4-4017-a8eb-882ef114eb9d')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  &lt;/svg&gt;
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-09d5859f-fee4-4017-a8eb-882ef114eb9d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-09d5859f-fee4-4017-a8eb-882ef114eb9d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following is the sytax for using CASE:</p>
<blockquote>
<p><strong>CASE</strong> <br>
â€ƒ <strong>WHEN</strong> <em>(condition_1)</em>  <strong>THEN</strong> <em>(result_1)</em> <br>
â€ƒ <strong>WHEN</strong> <em>(condition_2)</em>  <strong>THEN</strong> <em>(result_2)</em> <br>
â€ƒ [<strong>WHEN</strong> ...] <br>
â€ƒ [<strong>ELSE</strong> else_result] <br>
<strong>END</strong></p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="6.4.6)-Summary">
<a class="anchor" href="#6.4.6)-Summary" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.4.6) Summary<a class="anchor-link" href="#6.4.6)-Summary"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following summary is provided in the second article that was referenced in part 1:</p>
<ul>
<li>
<code>INNER JOIN</code> is the most common joining type, and is the default assumed, if you only include the command word <code>JOIN</code> in your query.</li>
<li>
<code>ON</code> is the phrase to specify the matching unique identifier in both tables.</li>
<li>If the matching key columns in both tables have exactly matching names USING(column_name) may be used instead of the <code>ON</code> command structure.</li>
<li>When combining tables, the column or field names must include a way for SQL to correctly identify their source table. This is accomplished by providing the full table name or assigning an alias.</li>
<li>Appropriate use of <code>WHERE</code> clause filters can enable queries to narrow the focus of the inquiry and search rapidly through very large datasets quickly containing millions of records.</li>
<li>As shown in the final query, there are many tools for manipulating text fields and including specific parts in your reports as you answer stakeholderâ€™s questions. Some of these essential tools are <code>SUBSTRING</code>, <code>POSITION</code>, <code>COALESCE</code> and <code>CASE</code> statements, which are all coming in the next sections.</li>
</ul>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="leonardodecastro/data_science_blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/data_science_blog/postgresql%20wit%20google%20colab/sql/2022/11/15/SQL-Tutorial-1.html" hidden></a>
</article>